---
title: "NDepend - impressions and review"
date: 2014-09-20 20:09
author: saguiitay
categories: [Development]
tags: [.Net, NDepend, Review]
redirect_from:
 - /2014-09-20-ndepend-impressions-and-review/
 - /development/ndepend-impressions-and-review/
---
**DISCLAIMER: I haven't been paid for this review and won't be. However, I did receive a free copy of the software.**

After downloading NDepend, my initial reaction to their "installation" process was REALLY?! you expect me to manually copy the files,
and don't include an installation/setup?!

(Update: It's been pointed out to me by NDepend that this was actually a very commonly requested and liked feature. After further thinking about this,
I can definitely see some advantages of such a deployment, especially for build servers)

After ignoring the instructions, and copying everything to my Program Files folder, I've decided to give this baby a shot.
I've heard of NDepend for a long time now, and even played a bit (5-10 minutes top) with an older version in the past. I was interesting
to see what it can do for me in my day-to-day job, so I started to visual tool, and pointed it to the source code of our main product.

That was a mistake.

This is a 50-ish projects solution, with dependencies from here till tomorrow. Don't get me wrong, NDepend handled it without any problems
(not an easy feat - even ReSharper is having a tough time). My problem was with the sheer amount of information it threw at me - I didn't know
where to start. So I decided to take a step back, and decided to start small. I reran the tool, this time on my
[OneDrive REST API](https://github.com/saguiitay/OneDriveRestAPI) library. This time I got something a bit less scary when I've opened the
dashboard:

![NDepend Dashboard]({{site.url}}/images/ndepend-dashboard.png)

As you can see, we got some statistics about the code, including lines of code/comments, numbers of assemblies/types/etc. as well as
Complexity indicators. The most important part, at least for now, is the Code Rules. Apparently, my library violates only a single rule, and
only once. Clicking the link there, brings you to the "Queries and Rules Explorer": 

![NDepend Queries and Rules Explorer]({{site.url}}/images/ndepend-queries-and-rules-explorer.png)

As you can see, NDepend comes with quite a [lot of rules](http://www.ndepend.com/default-rules/webframe.html) - I still need to explore
these, but those that probably interest me the most would be "Code Quality" and "Design". In this case, the critical rule that is
violated is under the "Naming Conventions" category. There are some "old fashioned" rules in there, such as requiring private fields to start
with "m_" - something I haven't used or seen in the last few years - luckily you can [edit these rules](http://www.ndepend.com/docs/cqlinq-syntax)
for yourself. Going back to the critical rule, it appears that I have a type called "HttpException". The name itself has nothing wrong
with it, but System.Web already has such a type (my implementation of HttpException actually inherits from it).

In this case, I've decided to rename my class to HttpServiceException. I've then decided to move to the Code Quality category,
and see what's going on there. Things didn't go so smoothly here. A couple of rules bothered me:

- Methods with too many overloads: My `HttpException` class has 8 constructors, all of which are just passing the arguments to the base class. Sure, I could probably reduce that number, but since this class was mostly auto-generated by ReSharper, and since these 8 constructors came from the .Net Framework itself, I didn't see the point of changing the code.
- Methods too complex: I'm always happy to simplify my code, especially in an open source project like this one. However, NDepend pointed me to a couple of Async methods, and gave me the build-generated `MoveNext` method as the too-complex methods. Not a lot I can do here. Ever more bothering, is the fact that NDepend doesn't appear to play-nicely with async-based code.

At t his point, I've decided to take a look at the other features of NDepend. I went back to my "monster" project. To be honest,
the Code Rules violations scared the hell out of me. I know we don't write perfect code, but 322 critical violations, 17700 violations total
seems a bit harsh. The Dependency Graph, after some clean-ups, showed me what I already knew about the solution - it's built by several
major areas - some common assemblies, which contains the model of the product, a group of several mostly-external "services", a middle
layer of concrete services, and lastly the actual "implementation" of the system (front-end, NServiceBus endpoints, etc.):

![NDepend Graph]({{site.url}}/images/ndepend-graph.png)

It is nice to see this visually, but it's nothing I didn't already know, from designing and building the system. I guess this might come
handy when introducing new team members to the source code.

That's it for now. All in all, I did find NDepend a useful tool to get some insights into your code. I am still not sure how and if I'll
integrate it into my day-to-day workflow. The main feature that spiked my interest is the Code rules, but I still need to further review
it, learn how to better use it, and see if it enhance my productivity in the long run.
